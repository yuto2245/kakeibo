# サーバー環境（実施した作業）
Node.jsプロジェクトを作成（npm init -y）。
TypeScriptを導入（npm install typescript ts-node @types/node --save-dev）。
依存インストール: npm install express mongoose oauth-1.0a bcrypt jsonwebtoken dotenv。


# 今後のタスク
ユーザーアカウントのモデル設計:
MongoDBに接続（.envでURIを設定）。
MongooseでUserスキーマを作成（例: interface User { email: string; password: string; zaimAccessToken?: string; zaimAccessSecret?: string; }）。
パスワードはbcryptでハッシュ化。Zaimトークンはオプションで、OAuth完了後に更新。

CRUDエンドポイントの実装:
登録 (Create): POST /api/users/register。emailとpasswordを受け取り、存在チェック後、Userを作成。レスポンスにJWTトークンを返す。
更新 (Update): PUT /api/users/:id。JWT認証後、emailやトークンを更新。例: Zaimトークンを追加。
削除 (Delete): DELETE /api/users/:id。JWT認証後、Userを削除。
取得 (Read): GET /api/users/:id。JWT認証後、User情報を返す（トークンはマスク）。
中間ミドルウェアでJWT検証を実装（jsonwebtoken.verify）。これにより、認証されたユーザーのみ操作可能。

OAuthトークン管理:
エンドポイント: POST /api/zaim/auth。フロントエンドからリクエストを受け、oauth-1.0aでRequest Tokenを取得。認証URLを返却。
コールバック: GET /api/zaim/callback。Verifierを受け、Access Token/Secretを取得し、Userに保存（更新操作）。
トークン取得のロジックは、以前のTypeScript例（oauth-1.0a使用）をバックエンドに移植。署名生成をデバッグしながら実装し、OAuthの基底文字列を理解してください。


バックエンドをローカルで起動（ts-node src/index.ts）し、Postmanでテスト。データベース操作のエラーハンドリングを追加し、現実的な耐障害性を確保。
3. API経由でのデータ取得
ユーザーアカウントのCRUDが完了したら、Zaim APIからデータを取得します。

バックエンドプロキシ:
エンドポイント: GET /api/zaim/money。JWT認証後、UserのZaimトークンを使ってAPIを呼び出し（https://api.zaim.net/v2/home/money）。
oauth-1.0aで署名し、fetchでリクエスト。レスポンスを加工（例: カテゴリ集計）してフロントエンドに返す。
レート制限対策: キャッシュ（Redisなど）を検討。

エラー処理: トークン無効時は再認証を促す。APIレスポンスの構造をTypeScriptの型で定義し、安全性を高める。


フロントエンドの設計 (React + TypeScript)
バックエンドが安定したら、Reactアプリを作成します。

セットアップ:
Create React App with TypeScript（npx create-react-app my-app --template typescript）。
依存: npm install axios react-router-dom @types/react-router-dom。

コンポーネント構造:
認証関連: Login/Registerコンポーネント。フォームでバックエンドのCRUDを呼び、JWTをlocalStorageに保存。
OAuthフロー: ZaimAuthButton。クリックでバックエンドの/authを呼び、認証URLを開く。コールバック後、トークンを更新。
データ表示: Dashboardコンポーネント。useEffectでバックエンドの/zaim/moneyを呼び、テーブルやチャート（例: Chart.js）で家計簿を表示。
ルーティング: React Routerで保護ルートを設定（useContextで認証状態管理）。

TypeScriptの活用: インターフェースでAPIレスポンス型を定義（例: interface MoneyData { amount: number; category: string; }）。Axiosのレスポンスを型付けし、コンパイル時エラーを防ぐ。